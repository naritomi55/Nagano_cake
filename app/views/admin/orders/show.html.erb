<h1>注文履歴詳細</h1>

<span>購入者</span>
  <%= link_to admin_customer_path(@customer.id) do %>
    <%= @order.customer.full_name %>
  <% end %></br>

<span>注文日</span>
  <%= @order.created_at %></br>

<span>配送先</span>
  〒<%= @order.postal_code%>　<%= @order.address %></br>

<span>支払方法</span>
 <%= @order.payment_method_i18n %></br>

<span>注文ステータス</span>
<%= form_with model: @order, url: admin_order_path(@order.id) do |f| %>
  <%= f.select :status, Order.statuses_i18n.invert %>
  <%= f.submit '更新' %>
<% end %></br>


<table class="table table-hover table-inverse">
　<thead>
   <tr>
     <th>商品名</th>
     <th>単価(税込)</th>
     <th>数量</th>
     <th>小計</th>
     <th>製作ステータス</th>
    </tr>
　</thead>
    <tbody>
      <% sum = 0 %>
    　<% @order.order_details.each do |item| %>
    　　<tr>
        　<td><%= item.item.name %></td>

          <td><%= item.add_tax_price %></td>

          <td><%= item.amount %></td>

          <td>
            <%= (item.add_tax_price)*(item.amount) %>
            <% sum = sum+(item.add_tax_price)*(item.amount) %>
          </td>

          <td>
            <%= form_with model: item, url: admin_order_detail_path(item.id), method: :patch do |f| %>
              <%= f.select :making_status, OrderDetail.making_statuses_i18n.invert %>
              <%= f.submit '更新' %>
              <% end %>
          </td>

        </tr>
    　<% end %>
    </tbody>
　</table>

<h1>商品合計</h1>
  <%= sum %>

<h1>送料</h1>
  <%= @order.shipping_cost %>

<h1>請求金額合計</h1>
  <%= @order.total_payment %>